(function(){var C=window.jQuery,v,aw,K="mathquill-command-id",l="mathquill-block-id",ar=Math.min,D=Math.max;var S=[].slice;function am(){}function f(L){var P=S.call(arguments,1);return function(){return L.apply(this,P)}}function aj(P,L){if(!L){throw new Error("prayer failed: "+P)}}var j=(function(R,ax,aB){function L(P){return typeof P==="object"}function aA(P){return typeof P==="function"}function az(){}function ay(aG,aC){if(aC===aB){aC=aG;aG=Object}function aH(){var aI=new P;if(aA(aI.init)){aI.init.apply(aI,arguments)}return aI}function P(){}aH.Bare=P;var aF=az[R]=aG[R];var aE=P[R]=aH[R]=new az;var aD;aE.constructor=aH;aH.mixin=function(aI){P[R]=aH[R]=ay(aH,aI)[R];return aH};return(aH.open=function(aJ){aD={};if(aA(aJ)){aD=aJ.call(aH,aE,aF,aH,aG)}else{if(L(aJ)){aD=aJ}}if(L(aD)){for(var aI in aD){if(ax.call(aD,aI)){aE[aI]=aD[aI]}}}if(!aA(aE.init)){aE.init=aG}return aH})(aC)}return ay})("prototype",({}).hasOwnProperty);var n=(function(){var L={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"};function R(ay){var aB=ay.which||ay.keyCode;var ax=L[aB];var aA;var az=[];if(ay.ctrlKey){az.push("Ctrl")}if(ay.originalEvent&&ay.originalEvent.metaKey){az.push("Meta")}if(ay.altKey){az.push("Alt")}if(ay.shiftKey){az.push("Shift")}aA=ax||String.fromCharCode(aB);if(!az.length&&!ax){return aA}az.push(aA);return az.join("-")}return function P(ay,aJ){var aL=null;var aE=null;if(!aJ){aJ={}}var aH=aJ.text||am;var aD=aJ.key||am;var aR=aJ.paste||am;var aB=aJ.cut||am;var aK=C(ay);var aT=C(aJ.container||aK);var aG=am,aC;function aQ(aU){aG=aU;clearTimeout(aC);aC=setTimeout(aU)}aT.bind("keydown keypress input keyup focusout paste",function(){aG()});function aM(aU){aG();aG=am;clearTimeout(aC);aK.val(aU);if(aU){aK[0].select()}}function aP(){var aU=aK[0];if(!("selectionStart" in aU)){return false}return aU.selectionStart!==aU.selectionEnd}function az(aV){var aU=aK.val();aK.val("");if(aU){aV(aU)}}function aI(){aD(R(aL),aL)}function aS(aU){aL=aU;aE=null;aI()}function aA(aU){if(aL&&aE){aI()}aE=aU;aQ(aO)}function aO(){if(aP()){return}az(aH)}function aF(){aL=aE=null}function ax(aU){aK.focus();aQ(aN)}function aN(){az(aR)}aT.bind({keydown:aS,keypress:aA,focusout:aF,cut:aB,paste:ax});return{select:aM}}}());var d=j(function(aI,aK,ay){function az(aM,aL){if(aM){aM="'"+aM+"'"}else{aM="EOF"}throw"Parse Error: "+aL+" at "+aM}aI.init=function(aL){this._=aL};aI.parse=function(aM){return this.skip(aJ)._(aM,aL,az);function aL(aO,aN){return aN}};aI.or=function(aM){aj("or is passed a parser",aM instanceof ay);var aL=this;return ay(function(aQ,aP,aO){return aL._(aQ,aP,aN);function aN(aR){return aM._(aQ,aP,aO)}})};aI.then=function(aM){var aL=this;return ay(function(aQ,aP,aN){return aL._(aQ,aO,aN);function aO(aT,aR){var aS=(aM instanceof ay?aM:aM(aR));aj("a parser is returned",aS instanceof ay);return aS._(aT,aP,aN)}})};aI.many=function(){var aL=this;return ay(function(aR,aQ,aO){var aN=[];while(aL._(aR,aP,aM)){}return aQ(aR,aN);function aP(aT,aS){aR=aT;aN.push(aS);return true}function aM(){return false}})};aI.times=function(aN,aL){if(arguments.length<2){aL=aN}var aM=this;return ay(function(aV,aU,aO){var aQ=[];var aX=true;var aP;for(var aS=0;aS<aN;aS+=1){aX=aM._(aV,aW,aR);if(!aX){return aO(aV,aP)}}for(;aS<aL&&aX;aS+=1){aX=aM._(aV,aW,aT)}return aU(aV,aQ);function aW(aZ,aY){aQ.push(aY);aV=aZ;return true}function aR(aZ,aY){aP=aY;aV=aZ;return false}function aT(aZ,aY){return false}})};aI.result=function(aL){return this.then(aA(aL))};aI.atMost=function(aL){return this.times(0,aL)};aI.atLeast=function(aM){var aL=this;return aL.times(aM).then(function(aN){return aL.many().map(function(aO){return aN.concat(aO)})})};aI.map=function(aL){return this.then(function(aM){return aA(aL(aM))})};aI.skip=function(aL){return this.then(function(aM){return aL.result(aM)})};var aB=this.string=function(aN){var aL=aN.length;var aM="expected '"+aN+"'";return ay(function(aR,aQ,aP){var aO=aR.slice(0,aL);if(aO===aN){return aQ(aR.slice(aL),aO)}else{return aP(aR,aM)}})};var aG=this.regex=function(aL){aj("regexp parser is anchored",aL.toString().charAt(1)==="^");var aM="expected "+aL;return ay(function(aR,aQ,aP){var aO=aL.exec(aR);if(aO){var aN=aO[0];return aQ(aR.slice(aN.length),aN)}else{return aP(aR,aM)}})};var aA=ay.succeed=function(aL){return ay(function(aN,aM){return aM(aN,aL)})};var ax=ay.fail=function(aL){return ay(function(aO,aM,aN){return aN(aO,aL)})};var R=ay.letter=aG(/^[a-z]/i);var aD=ay.letters=aG(/^[a-z]*/i);var aF=ay.digit=aG(/^[0-9]/);var P=ay.digits=aG(/^[0-9]*/);var L=ay.whitespace=aG(/^\s+/);var aE=ay.optWhitespace=aG(/^\s*/);var aC=ay.any=ay(function(aN,aM,aL){if(!aN){return aL(aN,"expected any character")}return aM(aN.slice(1),aN.charAt(0))});var aH=ay.all=ay(function(aN,aM,aL){return aM("",aN)});var aJ=ay.eof=ay(function(aN,aM,aL){if(aN){return aL(aN,"expected EOF")}return aM(aN,aN)})});var p=-1;var h=1;function av(L){aj("a direction was passed",L===p||L===h)}var W=j(C,function(L){L.insDirOf=function(P,R){return P===p?this.insertBefore(R.first()):this.insertAfter(R.last())};L.insAtDirEnd=function(P,R){return P===p?this.prependTo(R):this.appendTo(R)}});var A=j(function(L){L.parent=0;L[p]=0;L[h]=0;L.init=function(R,P,ax){this.parent=R;this[p]=P;this[h]=ax}});var E=j(function(L){L[p]=0;L[h]=0;L.parent=0;L.init=function(){this.ends={};this.ends[p]=0;this.ends[h]=0};L.children=function(){return M(this.ends[p],this.ends[h])};L.eachChild=function(P){return this.children().each(P)};L.foldChildren=function(P,R){return this.children().fold(P,R)};L.adopt=function(R,P,ax){M(this,this).adopt(R,P,ax);return this};L.disown=function(){M(this,this).disown();return this}});var M=j(function(L){L.init=function(R,ax){aj("no half-empty fragments",!R===!ax);this.ends={};if(!R){return}aj("left end node is passed to Fragment",R instanceof E);aj("right end node is passed to Fragment",ax instanceof E);aj("leftEnd and rightEnd have the same parent",R.parent===ax.parent);this.ends[p]=R;this.ends[h]=ax};function P(ax,R,ay){aj("a parent is always present",ax);aj("leftward is properly set up",(function(){if(!R){return ax.ends[p]===ay}return R[h]===ay&&R.parent===ax})());aj("rightward is properly set up",(function(){if(!ay){return ax.ends[h]===R}return ay[p]===R&&ay.parent===ax})())}L.adopt=function(ay,ax,aA){P(ay,ax,aA);var R=this;R.disowned=false;var az=R.ends[p];if(!az){return this}var aB=R.ends[h];if(ax){}else{ay.ends[p]=az}if(aA){aA[p]=aB}else{ay.ends[h]=aB}R.ends[h][h]=aA;R.each(function(aC){aC[p]=ax;aC.parent=ay;if(ax){ax[h]=aC}ax=aC});return R};L.disown=function(){var R=this;var ay=R.ends[p];if(!ay||R.disowned){return R}R.disowned=true;var az=R.ends[h];var ax=ay.parent;P(ax,ay[p],ay);P(ax,az,az[h]);if(ay[p]){ay[p][h]=az[h]}else{ax.ends[p]=az[h]}if(az[h]){az[h][p]=ay[p]}else{ax.ends[h]=ay[p]}return R};L.each=function(ay){var R=this;var ax=R.ends[p];if(!ax){return R}for(;ax!==R.ends[h][h];ax=ax[h]){if(ay.call(R,ax)===false){break}}return R};L.fold=function(R,ax){this.each(function(ay){R=ax.call(this,R,ay)});return R}});var k=(function(){var L=0;return function(){return L+=1}})();var I=j(E,function(L,P){L.init=function(R){P.init.call(this);this.id=k();I[this.id]=this};L.toString=function(){return"[MathElement "+this.id+"]"};L.bubble=function(az){var R=S.call(arguments,1);for(var ay=this;ay;ay=ay.parent){var ax=ay[az]&&ay[az].apply(ay,R);if(ax===false){break}}return this};L.postOrder=function(ay){var ax=S.call(arguments,1);if(typeof ay==="string"){var R=ay;ay=function(aA){if(R in aA){aA[R].apply(aA,ax)}}}(function az(aA){aA.eachChild(az);ay(aA)})(this)};L.jQ=W();L.jQadd=function(R){this.jQ=this.jQ.add(R)};this.jQize=function(R){var ax=W(R);ax.find("*").andSelf().each(function(){var aA=W(this),ay=aA.attr("mathquill-command-id"),az=aA.attr("mathquill-block-id");if(ay){I[ay].jQadd(aA)}if(az){I[az].jQadd(aA)}});return ax};L.finalizeInsert=function(){var R=this;R.postOrder("finalizeTree");R.postOrder("blur");R.postOrder("respace");if(R[h].respace){R[h].respace()}if(R[p].respace){R[p].respace()}R.postOrder("redraw");R.bubble("redraw")}});var G=j(I,function(L,P){L.init=function(ay,az,R){var ax=this;P.init.call(ax);if(!ax.ctrlSeq){ax.ctrlSeq=ay}if(az){ax.htmlTemplate=az}if(R){ax.textTemplate=R}};L.replaces=function(R){R.disown();this.replacedFragment=R};L.isEmpty=function(){return this.foldChildren(true,function(R,ax){return R&&ax.isEmpty()})};L.parser=function(){var ax=Z.block;var R=this;return ax.times(R.numBlocks()).map(function(az){R.blocks=az;for(var ay=0;ay<az.length;ay+=1){az[ay].adopt(R,R.ends[h],0)}return R})};L.createLeftOf=function(ay){var R=this;var ax=R.replacedFragment;R.createBlocks();I.jQize(R.html());if(ax){ax.adopt(R.ends[p],0,0);ax.jQ.appendTo(R.ends[p].jQ)}ay.jQ.before(R.jQ);ay[p]=R.adopt(ay.parent,ay[p],ay[h]);R.finalizeInsert(ay);R.placeCursor(ay)};L.createBlocks=function(){var ax=this,az=ax.numBlocks(),ay=ax.blocks=Array(az);for(var R=0;R<az;R+=1){var aA=ay[R]=y();aA.adopt(ax,ax.ends[h],0)}};L.respace=am;L.placeCursor=function(R){R.insAtRightEnd(this.foldChildren(this.ends[p],function(ax,ay){return ax.isEmpty()?ax:ay}))};L.remove=function(){this.disown();this.jQ.remove();this.postOrder(function(R){delete I[R.id]});return this};L.numBlocks=function(){var R=this.htmlTemplate.match(/&\d+/g);return R?R.length:0};L.html=function(){var aA=this;var aC=aA.blocks;var R=" mathquill-command-id="+aA.id;var aB=aA.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);aj("no unmatched angle brackets",aB.join("")===this.htmlTemplate);for(var ay=0,ax=aB[0];ax;ay+=1,ax=aB[ay]){if(ax.slice(-2)==="/>"){aB[ay]=ax.slice(0,-2)+R+"/>"}else{if(ax.charAt(0)==="<"){aj("not an unmatched top-level close tag",ax.charAt(1)!=="/");aB[ay]=ax.slice(0,-1)+R+">";var az=1;do{ay+=1,ax=aB[ay];aj("no missing close tags",ax);if(ax.slice(0,2)==="</"){az-=1}else{if(ax.charAt(0)==="<"&&ax.slice(-2)!=="/>"){az+=1}}}while(az>0)}}}return aB.join("").replace(/>&(\d+)/g,function(aE,aD){return" mathquill-block-id="+aC[aD].id+">"+aC[aD].join("html")})};L.latex=function(){return this.foldChildren(this.ctrlSeq,function(R,ax){return R+"{"+(ax.latex()||" ")+"}"})};L.textTemplate=[""];L.text=function(){var ax=this,R=0;return ax.foldChildren(ax.textTemplate[R],function(az,aA){R+=1;var ay=aA.text();if(az&&ax.textTemplate[R]==="("&&ay[0]==="("&&ay.slice(-1)===")"){return az+ay.slice(1,-1)+ax.textTemplate[R]}return az+aA.text()+(ax.textTemplate[R]||"")})}});var ad=j(G,function(L,P){L.init=function(ax,R,ay){if(!ay){ay=ax&&ax.length>1?ax.slice(1):ax}P.init.call(this,ax,R,[ay])};L.parser=function(){return d.succeed(this)};L.numBlocks=function(){return 0};L.replaces=function(R){R.remove()};L.createBlocks=am;L.latex=function(){return this.ctrlSeq};L.text=function(){return this.textTemplate};L.placeCursor=am;L.isEmpty=function(){return true}});var y=j(I,function(L){L.join=function(P){return this.foldChildren("",function(R,ax){return R+ax[P]()})};L.latex=function(){return this.join("latex")};L.text=function(){return this.ends[p]===this.ends[h]?this.ends[p].text():"("+this.join("text")+")"};L.isEmpty=function(){return this.ends[p]===0&&this.ends[h]===0};L.write=function(ay,P,ax){var R;if(P.match(/^[a-eg-zA-Z]$/)){R=u(P)}else{if(R=B[P]||Q[P]){R=R(P)}else{R=ah(P)}}if(ax){R.replaces(ax)}R.createLeftOf(ay)};L.focus=function(){this.jQ.addClass("hasCursor");this.jQ.removeClass("empty");return this};L.blur=function(){this.jQ.removeClass("hasCursor");if(this.isEmpty()){this.jQ.addClass("empty")}return this}});var af=j(M,function(L,P){L.init=function(R,ax){P.init.call(this,R,ax||R);this.jQ=this.fold(W(),function(ay,az){return az.jQ.add(ay)})};L.latex=function(){return this.fold("",function(ax,R){return ax+R.latex()})};L.remove=function(){this.jQ.remove();this.each(function(R){R.postOrder(function(ax){delete I[ax.id]})});return this.disown()}});function al(aA,aD,aC,R){var ax=aA.contents().detach();if(!aC){aA.addClass("mathquill-rendered-math")}aD.jQ=aA.attr(l,aD.id);aD.revert=function(){aA.empty().unbind(".mathquill").removeClass("mathquill-rendered-math mathquill-editable mathquill-textbox").append(ax)};var aG=aD.cursor=O(aD);aD.renderLatex(ax.text());var aH=aD.textarea=W('<span class="textarea"><textarea></textarea></span>'),aF=aH.children();var az;aD.selectionChanged=function(){if(az===v){az=setTimeout(L)}m(aA[0])};function L(){az=v;var aI=aG.selection?"$"+aG.selection.latex()+"$":"";aB.select(aI)}aA.bind("selectstart.mathquill",function(aI){if(aI.target!==aF[0]){aI.preventDefault()}aI.stopPropagation()});var ay,P=aG.blink;aA.bind("mousedown.mathquill",function(aJ){function aI(aM){aG.seek(W(aM.target),aM.pageX,aM.pageY);if(aG[p]!==ay[p]||aG.parent!==ay.parent){aG.selectFrom(ay)}return false}function aL(aM){delete aM.target;return aI(aM)}function aK(aM){ay=v;aG.blink=P;if(!aG.selection){if(R){aG.show()}else{aH.detach()}}aA.unbind("mousemove",aI);W(aM.target.ownerDocument).unbind("mousemove",aL).unbind("mouseup",aK)}setTimeout(function(){aF.focus()});aG.blink=am;aG.seek(W(aJ.target),aJ.pageX,aJ.pageY);ay=A(aG.parent,aG[p],aG[h]);if(!R){aA.prepend(aH)}aA.mousemove(aI);W(aJ.target.ownerDocument).mousemove(aL).mouseup(aK);return false});if(!R){var aB=n(aF,{container:aA});aA.bind("cut paste",false).bind("copy",L).prepend('<span class="selectable">$'+aD.latex()+"$</span>");aF.blur(function(){aG.clearSelection();setTimeout(aE)});function aE(){aH.detach()}return}var aB=n(aF,{container:aA,key:function(aJ,aI){aG.parent.bubble("onKey",aJ,aI)},text:function(aI){aG.parent.bubble("onText",aI)},cut:function(aI){if(aG.selection){setTimeout(function(){aG.prepareEdit();aG.parent.bubble("redraw")})}aI.stopPropagation()},paste:function(aI){if(aI.slice(0,1)==="$"&&aI.slice(-1)==="$"){aI=aI.slice(1,-1)}else{aI="\\text{"+aI+"}"}aG.writeLatex(aI).show()}});aA.prepend(aH);aA.addClass("mathquill-editable");if(aC){aA.addClass("mathquill-textbox")}aF.focus(function(aI){if(!aG.parent){aG.insAtRightEnd(aD)}aG.parent.jQ.addClass("hasCursor");if(aG.selection){aG.selection.jQ.removeClass("blur");setTimeout(aD.selectionChanged)}else{aG.show()}aI.stopPropagation()}).blur(function(aI){aG.hide().parent.blur();if(aG.selection){aG.selection.jQ.addClass("blur")}aI.stopPropagation()});aA.bind("focus.mathquill blur.mathquill",function(aI){aF.trigger(aI)}).blur()}var o=j(y,function(L,P){L.latex=function(){return P.latex.call(this).replace(/(\\[a-z]+) (?![a-z])/ig,"$1")};L.text=function(){return this.foldChildren("",function(R,ax){return R+ax.text()})};L.renderLatex=function(R){var ax=this.jQ;ax.children().slice(1).remove();this.ends[p]=this.ends[h]=0;delete this.cursor.selection;this.cursor.insAtRightEnd(this).writeLatex(R)};L.onKey=function(R,ay){switch(R){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":while(this.cursor[p]||this.cursor.selection){this.cursor.backspace()}break;case"Shift-Backspace":case"Backspace":this.cursor.backspace();break;case"Esc":case"Tab":case"Spacebar":var ax=this.cursor.parent;if(ax===this.cursor.root){if(R==="Spacebar"){ay.preventDefault()}return}this.cursor.prepareMove();if(ax[h]){this.cursor.insAtLeftEnd(ax[h])}else{this.cursor.insRightOf(ax.parent)}break;case"Shift-Tab":case"Shift-Esc":case"Shift-Spacebar":var ax=this.cursor.parent;if(ax===this.cursor.root){if(R==="Shift-Spacebar"){ay.preventDefault()}return}this.cursor.prepareMove();if(ax[p]){this.cursor.insAtRightEnd(ax[p])}else{this.cursor.insLeftOf(ax.parent)}break;case"Enter":break;case"End":this.cursor.prepareMove().insAtRightEnd(this.cursor.parent);break;case"Ctrl-End":this.cursor.prepareMove().insAtRightEnd(this);break;case"Shift-End":while(this.cursor[h]){this.cursor.selectRight()}break;case"Ctrl-Shift-End":while(this.cursor[h]||this.cursor.parent!==this){this.cursor.selectRight()}break;case"Home":this.cursor.prepareMove().insAtLeftEnd(this.cursor.parent);break;case"Ctrl-Home":this.cursor.prepareMove().insAtLeftEnd(this);break;case"Shift-Home":while(this.cursor[p]){this.cursor.selectLeft()}break;case"Ctrl-Shift-Home":while(this.cursor[p]||this.cursor.parent!==this){this.cursor.selectLeft()}break;case"Left":this.cursor.moveLeft();break;case"Shift-Left":this.cursor.selectLeft();break;case"Ctrl-Left":break;case"Right":this.cursor.moveRight();break;case"Shift-Right":this.cursor.selectRight();break;case"Ctrl-Right":break;case"Up":this.cursor.moveUp();break;case"Down":this.cursor.moveDown();break;case"Shift-Up":if(this.cursor[p]){while(this.cursor[p]){this.cursor.selectLeft()}}else{this.cursor.selectLeft()}case"Shift-Down":if(this.cursor[h]){while(this.cursor[h]){this.cursor.selectRight()}}else{this.cursor.selectRight()}case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":while(this.cursor[h]||this.cursor.selection){this.cursor.deleteForward()}break;case"Shift-Del":case"Del":this.cursor.deleteForward();break;case"Meta-A":case"Ctrl-A":if(this!==this.cursor.root){return}this.cursor.prepareMove().insAtRightEnd(this);while(this.cursor[p]){this.cursor.selectLeft()}break;default:return false}ay.preventDefault();return false};L.onText=function(R){this.cursor.write(R);return false}});var ao=j(G,function(L,P){L.init=function(R){P.init.call(this,"$");this.cursor=R};L.htmlTemplate='<span class="mathquill-rendered-math">&0</span>';L.createBlocks=function(){this.ends[p]=this.ends[h]=o();this.blocks=[this.ends[p]];this.ends[p].parent=this;this.ends[p].cursor=this.cursor;this.ends[p].write=function(ay,R,ax){if(R!=="$"){y.prototype.write.call(this,ay,R,ax)}else{if(this.isEmpty()){ay.insRightOf(this.parent).backspace().show();ah("\\$","$").createLeftOf(ay)}else{if(!ay[h]){ay.insRightOf(this.parent)}else{if(!ay[p]){ay.insLeftOf(this.parent)}else{y.prototype.write.call(this,ay,R,ax)}}}}}};L.latex=function(){return"$"+this.ends[p].latex()+"$"}});var ab=j(y,function(L){L.renderLatex=function(ay){var aI=this;var aG=aI.cursor;aI.jQ.children().slice(1).remove();aI.ends[p]=aI.ends[h]=0;delete aG.selection;aG.show().insAtRightEnd(aI);var aD=d.regex;var aB=d.string;var aH=d.eof;var aF=d.all;var aC=aB("$").then(Z).skip(aB("$").or(aH)).map(function(aL){var aK=ao(aG);aK.createBlocks();var aJ=aK.ends[p];aL.children().adopt(aJ,0,0);return aK});var aE=aB("\\$").result("$");var R=aE.or(aD(/^[^$]/)).map(ah);var P=aC.or(R).many();var ax=P.skip(aH).or(aF.result(false)).parse(ay);if(ax){for(var az=0;az<ax.length;az+=1){ax[az].adopt(aI,aI.ends[h],0)}var aA=aI.join("html");I.jQize(aA).appendTo(aI.jQ);this.finalizeInsert()}};L.onKey=function(P){if(P==="Spacebar"||P==="Shift-Spacebar"){return}o.prototype.onKey.apply(this,arguments)};L.onText=o.prototype.onText;L.write=function(ay,R,ax){if(ax){ax.remove()}if(R==="$"){ao(ay).createLeftOf(ay)}else{var P;if(R==="<"){P="&lt;"}else{if(R===">"){P="&gt;"}}ah(R,P).createLeftOf(ay)}}});var B={},Q={};var X,m=am,an=document.createElement("div"),au=an.style,J={transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1},b;for(var z in J){if(z in au){b=z;break}}if(b){X=function(P,L,R){P.css(b,"scale("+L+","+R+")")}}else{if("filter" in au){m=function(L){L.className=L.className};X=function(ax,L,az){L/=(1+(az-1)/2);ax.css("fontSize",az+"em");if(!ax.hasClass("matrixed-container")){ax.addClass("matrixed-container").wrapInner('<span class="matrixed"></span>')}var ay=ax.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+L+",SizingMethod='auto expand')");function R(){ax.css("marginRight",(ay.width()-1)*(L-1)/L+"px")}R();var P=setInterval(R);W(window).load(function(){clearTimeout(P);R()})}}else{X=function(P,L,R){P.css("fontSize",R+"em")}}}var N=j(G,function(L,P){L.init=function(ay,ax,R){P.init.call(this,ay,"<"+ax+" "+R+">&0</"+ax+">")}});Q.mathrm=f(N,"\\mathrm","span",'class="roman font"');Q.mathit=f(N,"\\mathit","i",'class="font"');Q.mathbf=f(N,"\\mathbf","b",'class="font"');Q.mathsf=f(N,"\\mathsf","span",'class="sans-serif font"');Q.mathtt=f(N,"\\mathtt","span",'class="monospace font"');Q.underline=f(N,"\\underline","span",'class="non-leaf underline"');Q.overline=Q.bar=f(N,"\\overline","span",'class="non-leaf overline"');var at=j(G,function(L,P){L.init=function(ax,R,ay){P.init.call(this,ax,"<"+R+' class="non-leaf">&0</'+R+">",[ay])};L.finalizeTree=function(){aj("SupSub is only _ and ^",this.ctrlSeq==="^"||this.ctrlSeq==="_");if(this.ctrlSeq==="_"){this.down=this.ends[p];this.ends[p].up=R}else{this.up=this.ends[p];this.ends[p].down=R}function R(az){var ax=this.parent,ay=az;do{if(ay[h]){az.insLeftOf(ax);return false}ay=ay.parent.parent}while(ay!==ax);az.insRightOf(ax);return false}};L.latex=function(){var R=this.ends[p].latex();if(R.length===1){return this.ctrlSeq+R}else{return this.ctrlSeq+"{"+(R||" ")+"}"}};L.redraw=function(){if(this[p]){this[p].respace()}if(!(this[p] instanceof at)){this.respace();if(this[h]&&!(this[h] instanceof at)){this[h].respace()}}};L.respace=function(){if(this[p].ctrlSeq==="\\int "||(this[p] instanceof at&&this[p].ctrlSeq!=this.ctrlSeq&&this[p][p]&&this[p][p].ctrlSeq==="\\int ")){if(!this.limit){this.limit=true;this.jQ.addClass("limit")}}else{if(this.limit){this.limit=false;this.jQ.removeClass("limit")}}this.respaced=this[p] instanceof at&&this[p].ctrlSeq!=this.ctrlSeq&&!this[p].respaced;if(this.respaced){var ax=+this.jQ.css("fontSize").slice(0,-2),R=this[p].jQ.outerWidth(),ay=this.jQ.outerWidth();this.jQ.css({left:(this.limit&&this.ctrlSeq==="_"?-0.25:0)-R/ax+"em",marginRight:0.1-ar(ay,R)/ax+"em"})}else{if(this.limit&&this.ctrlSeq==="_"){this.jQ.css({left:"-.25em",marginRight:""})}else{this.jQ.css({left:"",marginRight:""})}}if(this[h] instanceof at){this[h].respace()}return this}});Q.subscript=Q._=f(at,"_","sub","_");Q.superscript=Q.supscript=Q["^"]=f(at,"^","sup","**");var ag=Q.frac=Q.dfrac=Q.cfrac=Q.fraction=j(G,function(L,P){L.ctrlSeq="\\frac";L.htmlTemplate='<span class="fraction non-leaf"><span class="numerator">&0</span><span class="denominator">&1</span><span style="display:inline-block;width:0">&nbsp;</span></span>';L.textTemplate=["(","/",")"];L.finalizeTree=function(){this.up=this.ends[h].up=this.ends[p];this.down=this.ends[p].down=this.ends[h]}});var i=Q.over=B["/"]=j(ag,function(L,P){L.createLeftOf=function(ax){if(!this.replacedFragment){var R=ax[p];while(R&&!(R instanceof ap||R instanceof ai||R instanceof x||",;:".split("").indexOf(R.ctrlSeq)>-1)){R=R[p]}if(R instanceof x&&R[h] instanceof at){R=R[h];if(R[h] instanceof at&&R[h].ctrlSeq!=R.ctrlSeq){R=R[h]}}if(R!==ax[p]){this.replaces(af(R[h]||ax.parent.ends[p],ax[p]));ax[p]=R}}P.createLeftOf.call(this,ax)}});var w=Q.sqrt=Q["√"]=j(G,function(L,P){L.ctrlSeq="\\sqrt";L.htmlTemplate='<span class="non-leaf"><span class="scaled sqrt-prefix">&radic;</span><span class="non-leaf sqrt-stem">&0</span></span>';L.textTemplate=["sqrt(",")"];L.parser=function(){return Z.optBlock.then(function(R){return Z.block.map(function(ay){var ax=aq();ax.blocks=[R,ay];R.adopt(ax,0,0);ay.adopt(ax,R,0);return ax})}).or(P.parser.call(this))};L.redraw=function(){var R=this.ends[h].jQ;X(R.prev(),1,R.innerHeight()/+R.css("fontSize").slice(0,-2)-0.1)}});var a=Q.vec=j(G,function(L,P){L.ctrlSeq="\\vec";L.htmlTemplate='<span class="non-leaf"><span class="vector-prefix">&rarr;</span><span class="vector-stem">&0</span></span>';L.textTemplate=["vec(",")"]});var aq=Q.nthroot=j(w,function(L,P){L.htmlTemplate='<sup class="nthroot non-leaf">&0</sup><span class="scaled"><span class="sqrt-prefix scaled">&radic;</span><span class="sqrt-stem non-leaf">&1</span></span>';L.textTemplate=["sqrt[","](",")"];L.latex=function(){return"\\sqrt["+this.ends[p].latex()+"]{"+this.ends[h].latex()+"}"}});var F=j(G,function(L,P){L.init=function(ax,az,ay,R){P.init.call(this,"\\left"+ay,'<span class="non-leaf"><span class="scaled paren">'+ax+'</span><span class="non-leaf">&0</span><span class="scaled paren">'+az+"</span></span>",[ax,az]);this.end="\\right"+R};L.jQadd=function(){P.jQadd.apply(this,arguments);var R=this.jQ;this.bracketjQs=R.children(":first").add(R.children(":last"))};L.latex=function(){return this.ctrlSeq+this.ends[p].latex()+this.end};L.redraw=function(){var ax=this.ends[p].jQ;var R=ax.outerHeight()/+ax.css("fontSize").slice(0,-2);X(this.bracketjQs,ar(1+0.2*(R-1),1.2),1.05*R)}});Q.left=j(G,function(L){L.parser=function(){var R=d.regex;var P=d.string;var ax=d.succeed;var ay=d.optWhitespace;return ay.then(R(/^(?:[([|]|\\\{)/)).then(function(az){if(az.charAt(0)==="\\"){az=az.slice(1)}var aA=B[az]();return Z.map(function(aB){aA.blocks=[aB];aB.adopt(aA,0,0)}).then(P("\\right")).skip(ay).then(R(/^(?:[\])|]|\\\})/)).then(function(aB){if(aB.slice(-1)!==aA.end.slice(-1)){return d.fail("open doesn't match close")}return ax(aA)})})}});Q.right=j(G,function(L){L.parser=function(){return d.fail("unmatched \\right")}});Q.lbrace=B["{"]=f(F,"{","}","\\{","\\}");Q.langle=Q.lang=f(F,"&lang;","&rang;","\\langle ","\\rangle ");var ac=j(F,function(L,P){L.createLeftOf=function(R){if(!R[h]&&R.parent.parent&&R.parent.parent.end===this.end&&!this.replacedFragment){R.insRightOf(R.parent.parent)}else{P.createLeftOf.call(this,R)}};L.placeCursor=function(R){this.ends[p].blur();R.insRightOf(this)}});Q.rbrace=B["}"]=f(ac,"{","}","\\{","\\}");Q.rangle=Q.rang=f(ac,"&lang;","&rang;","\\langle ","\\rangle ");var t=function(L,P){L.init=function(R,ax){P.init.call(this,R,ax,R,ax)}};var T=j(F,t);Q.lparen=B["("]=f(T,"(",")");Q.lbrack=Q.lbracket=B["["]=f(T,"[","]");var V=j(ac,t);Q.rparen=B[")"]=f(V,"(",")");Q.rbrack=Q.rbracket=B["]"]=f(V,"[","]");var c=Q.lpipe=Q.rpipe=B["|"]=j(T,function(L,P){L.init=function(){P.init.call(this,"|","|")};L.createLeftOf=ac.prototype.createLeftOf});var ai=B.$=Q.text=Q.textnormal=Q.textrm=Q.textup=Q.textmd=j(G,function(L,P){L.ctrlSeq="\\text";L.htmlTemplate='<span class="text">&0</span>';L.replaces=function(R){if(R instanceof af){this.replacedText=R.remove().jQ.text()}else{if(typeof R==="string"){this.replacedText=R}}};L.textTemplate=['"','"'];L.parser=function(){var R=this;var ax=d.string;var ay=d.regex;var az=d.optWhitespace;return az.then(ax("{")).then(ay(/^[^}]*/)).skip(ax("}")).map(function(aD){R.createBlocks();var aC=R.ends[p];for(var aA=0;aA<aD.length;aA+=1){var aB=ah(aD.charAt(aA));aB.adopt(aC,aC.ends[h],0)}return R})};L.createBlocks=function(){this.ends[p]=this.ends[h]=s();this.blocks=[this.ends[p]];this.ends[p].parent=this};L.finalizeInsert=function(){this.ends[p].blur=function(){delete this.blur;return this};P.finalizeInsert.call(this)};L.createLeftOf=function(ax){P.createLeftOf.call(this,this.cursor=ax);if(this.replacedText){for(var R=0;R<this.replacedText.length;R+=1){this.ends[p].write(ax,this.replacedText.charAt(R))}}}});var s=j(y,function(L,P){L.onKey=function(R,ax){if(R==="Spacebar"||R==="Shift-Spacebar"){return false}};L.deleteOutOf=function(R,ax){if(this.isEmpty()){ax.insRightOf(this.parent)}};L.write=function(aA,ax,az){if(az){az.remove()}if(ax!=="$"){var R;if(ax==="<"){R="&lt;"}else{if(ax===">"){R="&gt;"}}ah(ax,R).createLeftOf(aA)}else{if(this.isEmpty()){aA.insRightOf(this.parent).backspace();ah("\\$","$").createLeftOf(aA)}else{if(!aA[h]){aA.insRightOf(this.parent)}else{if(!aA[p]){aA.insLeftOf(this.parent)}else{var ay=ai();ay.replaces(af(aA[h],this.ends[h]));aA.insRightOf(this.parent);ay.adopt=function(){delete this.adopt;this.adopt.apply(this,arguments);this[p]=0};ay.createLeftOf(aA);ay[p]=this.parent;aA.insLeftOf(ay)}}}}return false};L.blur=function(){this.jQ.removeClass("hasCursor");if(this.isEmpty()){var R=this.parent,ax=R.cursor;if(ax.parent===this){this.jQ.addClass("empty")}else{ax.hide();R.remove();if(ax[h]===R){ax[h]=R[h]}else{if(ax[p]===R){ax[p]=R[p]}}ax.show().parent.bubble("redraw")}}return this};L.focus=function(){P.focus.call(this);var ax=this.parent;if(ax[h].ctrlSeq===ax.ctrlSeq){var az=this,ay=ax.cursor,R=ax[h].ends[p];R.eachChild(function(aA){aA.parent=az;aA.jQ.appendTo(az.jQ)});if(this.ends[h]){this.ends[h][h]=R.ends[p]}else{this.ends[p]=R.ends[p]}R.ends[p][p]=this.ends[h];this.ends[h]=R.ends[h];R.parent.remove();if(ay[p]){ay.insRightOf(ay[p])}else{ay.insAtLeftEnd(this)}ay.parent.bubble("redraw")}else{if(ax[p].ctrlSeq===ax.ctrlSeq){var ay=ax.cursor;if(ay[p]){ax[p].ends[p].focus()}else{ay.insAtRightEnd(ax[p].ends[p])}}}return this}});function q(R,P,L){return j(ai,{ctrlSeq:R,htmlTemplate:"<"+P+" "+L+">&0</"+P+">"})}Q.em=Q.italic=Q.italics=Q.emph=Q.textit=Q.textsl=q("\\textit","i",'class="text"');Q.strong=Q.bold=Q.textbf=q("\\textbf","b",'class="text"');Q.sf=Q.textsf=q("\\textsf","span",'class="sans-serif text"');Q.tt=Q.texttt=q("\\texttt","span",'class="monospace text"');Q.textsc=q("\\textsc","span",'style="font-variant:small-caps" class="text"');Q.uppercase=q("\\uppercase","span",'style="text-transform:uppercase" class="text"');Q.lowercase=q("\\lowercase","span",'style="text-transform:lowercase" class="text"');var ae=B["\\"]=j(G,function(L,P){L.ctrlSeq="\\";L.replaces=function(R){this._replacedFragment=R.disown();this.isEmpty=function(){return false}};L.htmlTemplate='<span class="latex-command-input non-leaf">\\<span>&0</span></span>';L.textTemplate=["\\"];L.createBlocks=function(){P.createBlocks.call(this);this.ends[p].focus=function(){this.parent.jQ.addClass("hasCursor");if(this.isEmpty()){this.parent.jQ.removeClass("empty")}return this};this.ends[p].blur=function(){this.parent.jQ.removeClass("hasCursor");if(this.isEmpty()){this.parent.jQ.addClass("empty")}return this}};L.createLeftOf=function(ax){P.createLeftOf.call(this,ax);this.cursor=ax.insAtRightEnd(this.ends[p]);if(this._replacedFragment){var R=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("blur").bind("mousedown mousemove",function(ay){W(ay.target=R).trigger(ay);return false}).insertBefore(this.jQ).add(this.jQ)}this.ends[p].write=function(aA,ay,az){if(az){az.remove()}if(ay.match(/[a-z]/i)){ah(ay).createLeftOf(aA)}else{this.parent.renderCommand();if(ay!=="\\"||!this.isEmpty()){this.parent.parent.write(aA,ay)}}}};L.latex=function(){return"\\"+this.ends[p].latex()+" "};L.onKey=function(R,ax){if(R==="Tab"||R==="Enter"||R==="Spacebar"){this.renderCommand();ax.preventDefault();return false}};L.renderCommand=function(){this.jQ=this.jQ.last();this.remove();if(this[h]){this.cursor.insLeftOf(this[h])}else{this.cursor.insAtRightEnd(this.parent)}var ax=this.ends[p].latex(),R;if(!ax){ax="backslash"}this.cursor.insertCmd(ax,this._replacedFragment)}});var U=Q.binom=Q.binomial=j(G,function(L,P){L.ctrlSeq="\\binom";L.htmlTemplate='<span class="paren scaled">(</span><span class="non-leaf"><span class="array non-leaf"><span>&0</span><span>&1</span></span></span><span class="paren scaled">)</span>';L.textTemplate=["choose(",",",")"];L.redraw=function(){var ay=this.jQ.eq(1);var R=ay.outerHeight()/+ay.css("fontSize").slice(0,-2);var ax=this.jQ.filter(".paren");X(ax,ar(1+0.2*(R-1),1.2),1.05*R)}});var r=Q.choose=j(U,function(L){L.createLeftOf=i.prototype.createLeftOf});var H=Q.vector=j(G,function(L,P){L.ctrlSeq="\\vector";L.htmlTemplate='<span class="array"><span>&0</span></span>';L.latex=function(){return"\\begin{matrix}"+this.foldChildren([],function(R,ax){R.push(ax.latex());return R}).join("\\\\")+"\\end{matrix}"};L.text=function(){return"["+this.foldChildren([],function(R,ax){R.push(ax.text());return R}).join()+"]"};L.createLeftOf=function(R){P.createLeftOf.call(this,this.cursor=R)};L.onKey=function(R,ay){var ax=this.cursor.parent;if(ax.parent===this){if(R==="Enter"){var az=y();az.parent=this;az.jQ=W("<span></span>").attr(l,az.id).insertAfter(ax.jQ);if(ax[h]){ax[h][p]=az}else{this.ends[h]=az}az[h]=ax[h];ax[h]=az;az[p]=ax;this.bubble("redraw").cursor.insAtRightEnd(az);ay.preventDefault();return false}else{if(R==="Tab"&&!ax[h]){if(ax.isEmpty()){if(ax[p]){this.cursor.insRightOf(this);delete ax[p][h];this.ends[h]=ax[p];ax.jQ.remove();this.bubble("redraw");ay.preventDefault();return false}else{return}}var az=y();az.parent=this;az.jQ=W("<span></span>").attr(l,az.id).appendTo(this.jQ);this.ends[h]=az;ax[h]=az;az[p]=ax;this.bubble("redraw").cursor.insAtRightEnd(az);ay.preventDefault();return false}else{if(ay.which===8){if(ax.isEmpty()){if(ax[p]){this.cursor.insAtRightEnd(ax[p]);ax[p][h]=ax[h]}else{this.cursor.insLeftOf(this);this.ends[p]=ax[h]}if(ax[h]){ax[h][p]=ax[p]}else{this.ends[h]=ax[p]}ax.jQ.remove();if(this.isEmpty()){this.cursor.deleteForward()}else{this.bubble("redraw")}ay.preventDefault();return false}else{if(!this.cursor[p]){ay.preventDefault();return false}}}}}}}});Q.editable=j(ao,function(L,P){L.init=function(){G.prototype.init.call(this,"\\editable")};L.jQadd=function(){var R=this;P.jQadd.apply(R,arguments);var ax=R.ends[p].disown();var ay=R.jQ.children().detach();R.ends[p]=R.ends[h]=o();R.blocks=[R.ends[p]];R.ends[p].parent=R;al(R.jQ,R.ends[p],false,true);R.cursor=R.ends[p].cursor;ax.children().adopt(R.ends[p],0,0);ay.appendTo(R.ends[p].jQ);R.ends[p].cursor.insAtRightEnd(R.ends[p])};L.latex=function(){return this.ends[p].latex()};L.text=function(){return this.ends[p].text()}});Q.f=f(ad,"f",'<var class="florin">&fnof;</var><span style="display:inline-block;width:0">&nbsp;</span>');var u=j(ad,function(L,P){L.init=function(ax,R){P.init.call(this,ax,"<var>"+(R||ax)+"</var>")};L.text=function(){var R=this.ctrlSeq;if(this[p]&&!(this[p] instanceof u)&&!(this[p] instanceof ap)){R="*"+R}if(this[h]&&!(this[h] instanceof ap)&&!(this[h].ctrlSeq==="^")){R+="*"}return R}});var ah=j(ad,function(L,P){L.init=function(ax,R){P.init.call(this,ax,"<span>"+(R||ax)+"</span>")}});B[" "]=f(ah,"\\:"," ");Q.prime=B["'"]=f(ah,"'","&prime;");var g=j(ad,function(L,P){L.init=function(ax,R){P.init.call(this,ax,'<span class="nonSymbola">'+(R||ax)+"</span>")}});Q["@"]=g;Q["&"]=f(g,"\\&","&amp;");Q["%"]=f(g,"\\%","%");Q.alpha=Q.beta=Q.gamma=Q.delta=Q.zeta=Q.eta=Q.theta=Q.iota=Q.kappa=Q.mu=Q.nu=Q.xi=Q.rho=Q.sigma=Q.tau=Q.chi=Q.psi=Q.omega=j(u,function(L,P){L.init=function(R){P.init.call(this,"\\"+R+" ","&"+R+";")}});Q.phi=f(u,"\\phi ","&#981;");Q.phiv=Q.varphi=f(u,"\\varphi ","&phi;");Q.epsilon=f(u,"\\epsilon ","&#1013;");Q.epsiv=Q.varepsilon=f(u,"\\varepsilon ","&epsilon;");Q.piv=Q.varpi=f(u,"\\varpi ","&piv;");Q.sigmaf=Q.sigmav=Q.varsigma=f(u,"\\varsigma ","&sigmaf;");Q.thetav=Q.vartheta=Q.thetasym=f(u,"\\vartheta ","&thetasym;");Q.upsilon=Q.upsi=f(u,"\\upsilon ","&upsilon;");Q.gammad=Q.Gammad=Q.digamma=f(u,"\\digamma ","&#989;");Q.kappav=Q.varkappa=f(u,"\\varkappa ","&#1008;");Q.rhov=Q.varrho=f(u,"\\varrho ","&#1009;");Q.pi=Q["π"]=f(g,"\\pi ","&pi;");Q.lambda=f(g,"\\lambda ","&lambda;");Q.Upsilon=Q.Upsi=Q.upsih=Q.Upsih=f(ad,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>');Q.Gamma=Q.Delta=Q.Theta=Q.Lambda=Q.Xi=Q.Pi=Q.Sigma=Q.Phi=Q.Psi=Q.Omega=Q.forall=j(ah,function(L,P){L.init=function(R){P.init.call(this,"\\"+R+" ","&"+R+";")}});var ak=j(G,function(L){L.init=function(P){this.latex=P};L.createLeftOf=function(P){P.writeLatex(this.latex)};L.parser=function(){var P=Z.parse(this.latex).children();return d.succeed(P)}});Q["¹"]=f(ak,"^1");Q["²"]=f(ak,"^2");Q["³"]=f(ak,"^3");Q["¼"]=f(ak,"\\frac14");Q["½"]=f(ak,"\\frac12");Q["¾"]=f(ak,"\\frac34");var ap=j(ad,function(L,P){L.init=function(ax,R,ay){P.init.call(this,ax,'<span class="binary-operator">'+R+"</span>",ay)}});var e=j(ap,function(L){L.init=ah.prototype.init;L.respace=function(){if(!this[p]){this.jQ[0].className=""}else{if(this[p] instanceof ap&&this[h]&&!(this[h] instanceof ap)){this.jQ[0].className="unary-operator"}else{this.jQ[0].className="binary-operator"}}return this}});Q["+"]=f(e,"+","+");Q["–"]=Q["-"]=f(e,"-","&minus;");Q["±"]=Q.pm=Q.plusmn=Q.plusminus=f(e,"\\pm ","&plusmn;");Q.mp=Q.mnplus=Q.minusplus=f(e,"\\mp ","&#8723;");B["*"]=Q.sdot=Q.cdot=f(ap,"\\cdot ","&middot;");Q["="]=f(ap,"=","=");Q["<"]=f(ap,"<","&lt;");Q[">"]=f(ap,">","&gt;");Q.notin=Q.sim=Q.cong=Q.equiv=Q.oplus=Q.otimes=j(ap,function(L,P){L.init=function(R){P.init.call(this,"\\"+R+" ","&"+R+";")}});Q.times=f(ap,"\\times ","&times;","[x]");Q["÷"]=Q.div=Q.divide=Q.divides=f(ap,"\\div ","&divide;","[/]");Q["≠"]=Q.ne=Q.neq=f(ap,"\\ne ","&ne;");Q.ast=Q.star=Q.loast=Q.lowast=f(ap,"\\ast ","&lowast;");Q.therefor=Q.therefore=f(ap,"\\therefore ","&there4;");Q.cuz=Q.because=f(ap,"\\because ","&#8757;");Q.prop=Q.propto=f(ap,"\\propto ","&prop;");Q["≈"]=Q.asymp=Q.approx=f(ap,"\\approx ","&asymp;");Q.lt=f(ap,"<","&lt;");Q.gt=f(ap,">","&gt;");Q["≤"]=Q.le=Q.leq=f(ap,"\\le ","&le;");Q["≥"]=Q.ge=Q.geq=f(ap,"\\ge ","&ge;");Q.isin=Q["in"]=f(ap,"\\in ","&isin;");Q.ni=Q.contains=f(ap,"\\ni ","&ni;");Q.notni=Q.niton=Q.notcontains=Q.doesnotcontain=f(ap,"\\not\\ni ","&#8716;");Q.sub=Q.subset=f(ap,"\\subset ","&sub;");Q.sup=Q.supset=Q.superset=f(ap,"\\supset ","&sup;");Q.nsub=Q.notsub=Q.nsubset=Q.notsubset=f(ap,"\\not\\subset ","&#8836;");Q.nsup=Q.notsup=Q.nsupset=Q.notsupset=Q.nsuperset=Q.notsuperset=f(ap,"\\not\\supset ","&#8837;");Q.sube=Q.subeq=Q.subsete=Q.subseteq=f(ap,"\\subseteq ","&sube;");Q.supe=Q.supeq=Q.supsete=Q.supseteq=Q.supersete=Q.superseteq=f(ap,"\\supseteq ","&supe;");Q.nsube=Q.nsubeq=Q.notsube=Q.notsubeq=Q.nsubsete=Q.nsubseteq=Q.notsubsete=Q.notsubseteq=f(ap,"\\not\\subseteq ","&#8840;");Q.nsupe=Q.nsupeq=Q.notsupe=Q.notsupeq=Q.nsupsete=Q.nsupseteq=Q.notsupsete=Q.notsupseteq=Q.nsupersete=Q.nsuperseteq=Q.notsupersete=Q.notsuperseteq=f(ap,"\\not\\supseteq ","&#8841;");var x=j(ad,function(L,P){L.init=function(ax,R){P.init.call(this,ax,"<big>"+R+"</big>")}});Q["∑"]=Q.sum=Q.summation=f(x,"\\sum ","&sum;");Q["∏"]=Q.prod=Q.product=f(x,"\\prod ","&prod;");Q.coprod=Q.coproduct=f(x,"\\coprod ","&#8720;");Q["∫"]=Q["int"]=Q.integral=f(x,"\\int ","&int;");Q.N=Q.naturals=Q.Naturals=f(ah,"\\mathbb{N}","&#8469;");Q.P=Q.primes=Q.Primes=Q.projective=Q.Projective=Q.probability=Q.Probability=f(ah,"\\mathbb{P}","&#8473;");Q.Z=Q.integers=Q.Integers=f(ah,"\\mathbb{Z}","&#8484;");Q.Q=Q.rationals=Q.Rationals=f(ah,"\\mathbb{Q}","&#8474;");Q.R=Q.reals=Q.Reals=f(ah,"\\mathbb{R}","&#8477;");Q.C=Q.complex=Q.Complex=Q.complexes=Q.Complexes=Q.complexplane=Q.Complexplane=Q.ComplexPlane=f(ah,"\\mathbb{C}","&#8450;");Q.H=Q.Hamiltonian=Q.quaternions=Q.Quaternions=f(ah,"\\mathbb{H}","&#8461;");Q.quad=Q.emsp=f(ah,"\\quad ","    ");Q.qquad=f(ah,"\\qquad ","        ");Q.diamond=f(ah,"\\diamond ","&#9671;");Q.bigtriangleup=f(ah,"\\bigtriangleup ","&#9651;");Q.ominus=f(ah,"\\ominus ","&#8854;");Q.uplus=f(ah,"\\uplus ","&#8846;");Q.bigtriangledown=f(ah,"\\bigtriangledown ","&#9661;");Q.sqcap=f(ah,"\\sqcap ","&#8851;");Q.triangleleft=f(ah,"\\triangleleft ","&#8882;");Q.sqcup=f(ah,"\\sqcup ","&#8852;");Q.triangleright=f(ah,"\\triangleright ","&#8883;");Q.odot=f(ah,"\\odot ","&#8857;");Q.bigcirc=f(ah,"\\bigcirc ","&#9711;");Q.dagger=f(ah,"\\dagger ","&#0134;");Q.ddagger=f(ah,"\\ddagger ","&#135;");Q.wr=f(ah,"\\wr ","&#8768;");Q.amalg=f(ah,"\\amalg ","&#8720;");Q.models=f(ah,"\\models ","&#8872;");Q.prec=f(ah,"\\prec ","&#8826;");Q.succ=f(ah,"\\succ ","&#8827;");Q.preceq=f(ah,"\\preceq ","&#8828;");Q.succeq=f(ah,"\\succeq ","&#8829;");Q.simeq=f(ah,"\\simeq ","&#8771;");Q.mid=f(ah,"\\mid ","&#8739;");Q.ll=f(ah,"\\ll ","&#8810;");Q.gg=f(ah,"\\gg ","&#8811;");Q.parallel=f(ah,"\\parallel ","&#8741;");Q.bowtie=f(ah,"\\bowtie ","&#8904;");Q.sqsubset=f(ah,"\\sqsubset ","&#8847;");Q.sqsupset=f(ah,"\\sqsupset ","&#8848;");Q.smile=f(ah,"\\smile ","&#8995;");Q.sqsubseteq=f(ah,"\\sqsubseteq ","&#8849;");Q.sqsupseteq=f(ah,"\\sqsupseteq ","&#8850;");Q.doteq=f(ah,"\\doteq ","&#8784;");Q.frown=f(ah,"\\frown ","&#8994;");Q.vdash=f(ah,"\\vdash ","&#8870;");Q.dashv=f(ah,"\\dashv ","&#8867;");Q.longleftarrow=f(ah,"\\longleftarrow ","&#8592;");Q.longrightarrow=f(ah,"\\longrightarrow ","&#8594;");Q.Longleftarrow=f(ah,"\\Longleftarrow ","&#8656;");Q.Longrightarrow=f(ah,"\\Longrightarrow ","&#8658;");Q.longleftrightarrow=f(ah,"\\longleftrightarrow ","&#8596;");Q.updownarrow=f(ah,"\\updownarrow ","&#8597;");Q.Longleftrightarrow=f(ah,"\\Longleftrightarrow ","&#8660;");Q.Updownarrow=f(ah,"\\Updownarrow ","&#8661;");Q.mapsto=f(ah,"\\mapsto ","&#8614;");Q.nearrow=f(ah,"\\nearrow ","&#8599;");Q.hookleftarrow=f(ah,"\\hookleftarrow ","&#8617;");Q.hookrightarrow=f(ah,"\\hookrightarrow ","&#8618;");Q.searrow=f(ah,"\\searrow ","&#8600;");Q.leftharpoonup=f(ah,"\\leftharpoonup ","&#8636;");Q.rightharpoonup=f(ah,"\\rightharpoonup ","&#8640;");Q.swarrow=f(ah,"\\swarrow ","&#8601;");Q.leftharpoondown=f(ah,"\\leftharpoondown ","&#8637;");Q.rightharpoondown=f(ah,"\\rightharpoondown ","&#8641;");Q.nwarrow=f(ah,"\\nwarrow ","&#8598;");Q.ldots=f(ah,"\\ldots ","&#8230;");Q.cdots=f(ah,"\\cdots ","&#8943;");Q.vdots=f(ah,"\\vdots ","&#8942;");Q.ddots=f(ah,"\\ddots ","&#8944;");Q.surd=f(ah,"\\surd ","&#8730;");Q.triangle=f(ah,"\\triangle ","&#9653;");Q.ell=f(ah,"\\ell ","&#8467;");Q.top=f(ah,"\\top ","&#8868;");Q.flat=f(ah,"\\flat ","&#9837;");Q.natural=f(ah,"\\natural ","&#9838;");Q.sharp=f(ah,"\\sharp ","&#9839;");Q.wp=f(ah,"\\wp ","&#8472;");Q.bot=f(ah,"\\bot ","&#8869;");Q.clubsuit=f(ah,"\\clubsuit ","&#9827;");Q.diamondsuit=f(ah,"\\diamondsuit ","&#9826;");Q.heartsuit=f(ah,"\\heartsuit ","&#9825;");Q.spadesuit=f(ah,"\\spadesuit ","&#9824;");Q.oint=f(ah,"\\oint ","&#8750;");Q.bigcap=f(ah,"\\bigcap ","&#8745;");Q.bigcup=f(ah,"\\bigcup ","&#8746;");Q.bigsqcup=f(ah,"\\bigsqcup ","&#8852;");Q.bigvee=f(ah,"\\bigvee ","&#8744;");Q.bigwedge=f(ah,"\\bigwedge ","&#8743;");Q.bigodot=f(ah,"\\bigodot ","&#8857;");Q.bigotimes=f(ah,"\\bigotimes ","&#8855;");Q.bigoplus=f(ah,"\\bigoplus ","&#8853;");Q.biguplus=f(ah,"\\biguplus ","&#8846;");Q.lfloor=f(ah,"\\lfloor ","&#8970;");Q.rfloor=f(ah,"\\rfloor ","&#8971;");Q.lceil=f(ah,"\\lceil ","&#8968;");Q.rceil=f(ah,"\\rceil ","&#8969;");Q.slash=f(ah,"\\slash ","&#47;");Q.opencurlybrace=f(ah,"\\opencurlybrace ","&#123;");Q.closecurlybrace=f(ah,"\\closecurlybrace ","&#125;");Q.caret=f(ah,"\\caret ","^");Q.underscore=f(ah,"\\underscore ","_");Q.backslash=f(ah,"\\backslash ","\\");Q.vert=f(ah,"|");Q.perp=Q.perpendicular=f(ah,"\\perp ","&perp;");Q.nabla=Q.del=f(ah,"\\nabla ","&nabla;");Q.hbar=f(ah,"\\hbar ","&#8463;");Q.AA=Q.Angstrom=Q.angstrom=f(ah,"\\text\\AA ","&#8491;");Q.ring=Q.circ=Q.circle=f(ah,"\\circ ","&#8728;");Q.bull=Q.bullet=f(ah,"\\bullet ","&bull;");Q.setminus=Q.smallsetminus=f(ah,"\\setminus ","&#8726;");Q.not=Q["¬"]=Q.neg=f(ah,"\\neg ","&not;");Q["…"]=Q.dots=Q.ellip=Q.hellip=Q.ellipsis=Q.hellipsis=f(ah,"\\dots ","&hellip;");Q.converges=Q.darr=Q.dnarr=Q.dnarrow=Q.downarrow=f(ah,"\\downarrow ","&darr;");Q.dArr=Q.dnArr=Q.dnArrow=Q.Downarrow=f(ah,"\\Downarrow ","&dArr;");Q.diverges=Q.uarr=Q.uparrow=f(ah,"\\uparrow ","&uarr;");Q.uArr=Q.Uparrow=f(ah,"\\Uparrow ","&uArr;");Q.to=f(ap,"\\to ","&rarr;");Q.rarr=Q.rightarrow=f(ah,"\\rightarrow ","&rarr;");Q.implies=f(ap,"\\Rightarrow ","&rArr;");Q.rArr=Q.Rightarrow=f(ah,"\\Rightarrow ","&rArr;");Q.gets=f(ap,"\\gets ","&larr;");Q.larr=Q.leftarrow=f(ah,"\\leftarrow ","&larr;");Q.impliedby=f(ap,"\\Leftarrow ","&lArr;");Q.lArr=Q.Leftarrow=f(ah,"\\Leftarrow ","&lArr;");Q.harr=Q.lrarr=Q.leftrightarrow=f(ah,"\\leftrightarrow ","&harr;");Q.iff=f(ap,"\\Leftrightarrow ","&hArr;");Q.hArr=Q.lrArr=Q.Leftrightarrow=f(ah,"\\Leftrightarrow ","&hArr;");Q.Re=Q.Real=Q.real=f(ah,"\\Re ","&real;");Q.Im=Q.imag=Q.image=Q.imagin=Q.imaginary=Q.Imaginary=f(ah,"\\Im ","&image;");Q.part=Q.partial=f(ah,"\\partial ","&part;");Q.inf=Q.infin=Q.infty=Q.infinity=f(ah,"\\infty ","&infin;");Q.alef=Q.alefsym=Q.aleph=Q.alephsym=f(ah,"\\aleph ","&alefsym;");Q.xist=Q.xists=Q.exist=Q.exists=f(ah,"\\exists ","&exist;");Q.and=Q.land=Q.wedge=f(ah,"\\wedge ","&and;");Q.or=Q.lor=Q.vee=f(ah,"\\vee ","&or;");Q.o=Q.O=Q.empty=Q.emptyset=Q.oslash=Q.Oslash=Q.nothing=Q.varnothing=f(ap,"\\varnothing ","&empty;");Q.cup=Q.union=f(ap,"\\cup ","&cup;");Q.cap=Q.intersect=Q.intersection=f(ap,"\\cap ","&cap;");Q.deg=Q.degree=f(ah,"^\\circ ","&deg;");Q.ang=Q.angle=f(ah,"\\angle ","&ang;");var aa=j(ad,function(L,P){L.init=function(R){P.init.call(this,"\\"+R+" ","<span>"+R+"</span>")};L.respace=function(){this.jQ[0].className=(this[h] instanceof at||this[h] instanceof F)?"":"non-italicized-function"}});Q.ln=Q.lg=Q.log=Q.span=Q.proj=Q.det=Q.dim=Q.min=Q.max=Q.mod=Q.lcm=Q.gcd=Q.gcf=Q.hcf=Q.lim=aa;(function(){var P=["sin","cos","tan","sec","cosec","csc","cotan","cot"];for(var L in P){Q[P[L]]=Q[P[L]+"h"]=Q["a"+P[L]]=Q["arc"+P[L]]=Q["a"+P[L]+"h"]=Q["arc"+P[L]+"h"]=aa}}());var Z=(function(){function aJ(aM){var aN=y();aM.adopt(aN,0,0);return aN}function aC(aO){var aN=aO[0]||y();for(var aM=1;aM<aO.length;aM+=1){aO[aM].children().adopt(aN,aN.ends[h],0)}return aN}var L=d.string;var ax=d.regex;var aL=d.letter;var aD=d.any;var aI=d.optWhitespace;var aK=d.succeed;var aB=d.fail;var aE=aL.map(u);var aF=ax(/^[^${}\\_^]/).map(ah);var P=ax(/^[^\\a-eg-zA-Z]/).or(L("\\").then(ax(/^[a-z]+/i).or(ax(/^\s+/).result(" ")).or(aD))).then(function(aN){var aM=Q[aN];if(aM){return aM(aN).parser()}else{return aB("unknown command: \\"+aN)}});var ay=P.or(aE).or(aF);var aA=L("{").then(function(){return aH}).skip(L("}"));var az=aI.then(aA.or(ay.map(aJ)));var aH=az.many().map(aC).skip(aI);var aG=L("[").then(az.then(function(aM){return aM.join("latex")!=="]"?aK(aM):aB()}).many().map(aC).skip(aI)).skip(L("]"));var R=aH;R.block=az;R.optBlock=aG;return R})();var O=j(A,function(P){P.init=function(ay){this.parent=this.root=ay;var az=this.jQ=this._jQ=W('<span class="cursor">&zwj;</span>');this.blink=function(){az.toggleClass("blink")};this.upDownCache={}};P.show=function(){this.jQ=this._jQ.removeClass("blink");if("intervalId" in this){clearInterval(this.intervalId)}else{if(this[h]){if(this.selection&&this.selection.ends[p][p]===this[p]){this.jQ.insertBefore(this.selection.jQ)}else{this.jQ.insertBefore(this[h].jQ.first())}}else{this.jQ.appendTo(this.parent.jQ)}this.parent.focus()}this.intervalId=setInterval(this.blink,500);return this};P.hide=function(){if("intervalId" in this){clearInterval(this.intervalId)}delete this.intervalId;this.jQ.detach();this.jQ=W();return this};P.withDirInsertAt=function(az,aB,ay,aC){var aA=this.parent;this.parent=aB;this[az]=ay;this[-az]=aC;aA.blur()};P.insDirOf=function(ay,az){av(ay);this.withDirInsertAt(ay,az.parent,az[ay],az);this.parent.jQ.addClass("hasCursor");this.jQ.insDirOf(ay,az.jQ);return this};P.insLeftOf=function(ay){return this.insDirOf(p,ay)};P.insRightOf=function(ay){return this.insDirOf(h,ay)};P.insAtDirEnd=function(ay,az){av(ay);this.withDirInsertAt(ay,az,0,az.ends[ay]);if(ay===p&&az.textarea){this.jQ.insDirOf(-ay,az.textarea)}else{this.jQ.insAtDirEnd(ay,az.jQ)}az.focus();return this};P.insAtLeftEnd=function(ay){return this.insAtDirEnd(p,ay)};P.insAtRightEnd=function(ay){return this.insAtDirEnd(h,ay)};P.hopDir=function(ay){av(ay);this.jQ.insDirOf(ay,this[ay].jQ);this[-ay]=this[ay];this[ay]=this[ay][ay];return this};P.hopLeft=function(){return this.hopDir(p)};P.hopRight=function(){return this.hopDir(h)};P.moveDirWithin=function(ay,az){av(ay);if(this[ay]){if(this[ay].ends[-ay]){this.insAtDirEnd(-ay,this[ay].ends[-ay])}else{this.hopDir(ay)}}else{if(this.parent===az){return}if(this.parent[ay]){this.insAtDirEnd(-ay,this.parent[ay])}else{this.insDirOf(ay,this.parent.parent)}}};P.moveLeftWithin=function(ay){return this.moveDirWithin(p,ay)};P.moveRightWithin=function(ay){return this.moveDirWithin(h,ay)};P.moveDir=function(ay){av(ay);R(this);if(this.selection){this.insDirOf(ay,this.selection.ends[ay]).clearSelection()}else{this.moveDirWithin(ay,this.root)}return this.show()};P.moveLeft=function(){return this.moveDir(p)};P.moveRight=function(){return this.moveDir(h)};P.moveUp=function(){return L(this,"up")};P.moveDown=function(){return L(this,"down")};function L(ay,az){if(ay[h][az]){ay.insAtLeftEnd(ay[h][az])}else{if(ay[p][az]){ay.insAtRightEnd(ay[p][az])}else{var aC=ay.parent;do{var aD=aC[az];if(aD){if(typeof aD==="function"){aD=aC[az](ay)}if(aD===false||aD instanceof y){ay.upDownCache[aC.id]=A(ay.parent,ay[p],ay[h]);if(aD instanceof y){var aB=ay.upDownCache[aD.id];if(aB){if(aB[h]){ay.insLeftOf(aB[h])}else{ay.insAtRightEnd(aB.parent)}}else{var aA=ax(ay).left;ay.insAtRightEnd(aD);ay.seekHoriz(aA,aD)}}break}}aC=aC.parent.parent}while(aC)}}return ay.clearSelection().show()}P.seek=function(aB,az,ay){R(this);var aA,aD,aC=this.clearSelection().show();if(aB.hasClass("empty")){aC.insAtLeftEnd(I[aB.attr(l)]);return aC}aA=I[aB.attr(K)];if(aA instanceof ad){if(aB.outerWidth()>2*(az-aB.offset().left)){aC.insLeftOf(aA)}else{aC.insRightOf(aA)}return aC}if(!aA){aD=I[aB.attr(l)];if(!aD){aB=aB.parent();aA=I[aB.attr(K)];if(!aA){aD=I[aB.attr(l)];if(!aD){aD=aC.root}}}}if(aA){aC.insRightOf(aA)}else{aC.insAtRightEnd(aD)}return aC.seekHoriz(az,aC.root)};P.seekHoriz=function(ay,aB){var aA=this;var az=ax(aA).left-ay;var aC;do{aA.moveLeftWithin(aB);aC=az;az=ax(aA).left-ay}while(az>0&&(aA[p]||aA.parent!==aB));if(-az>aC){aA.moveRightWithin(aB)}return aA};function ax(ay){var az=ay.jQ.removeClass("cursor").offset();ay.jQ.addClass("cursor");return az}P.writeLatex=function(aB){var az=this;R(az);az.show().deleteSelection();var aA=d.all;var ay=d.eof;var aC=Z.skip(ay).or(aA.result(false)).parse(aB);if(aC){aC.children().adopt(az.parent,az[p],az[h]);I.jQize(aC.join("html")).insertBefore(az.jQ);az[p]=aC.ends[h];aC.finalizeInsert();az.parent.bubble("redraw")}return this.hide()};P.write=function(az){var ay=this.prepareWrite();return this.insertCh(az,ay)};P.insertCh=function(ay,az){this.parent.write(this,ay,az);return this};P.insertCmd=function(ay,aA){var az=Q[ay];if(az){az=az(ay);if(aA){az.replaces(aA)}az.createLeftOf(this)}else{az=ai();az.replaces(ay);az.ends[p].focus=function(){delete this.focus;return this};az.createLeftOf(this);this.insRightOf(az);if(aA){aA.remove()}}return this};P.unwrapGramp=function(){var aA=this.parent.parent;var ay=aA.parent;var aB=aA[h];var aC=this;var az=aA[p];aA.disown().eachChild(function(aD){if(aD.isEmpty()){return}aD.children().adopt(ay,az,aB).each(function(aE){aE.jQ.insertBefore(aA.jQ.first())});az=aD.ends[h]});if(!this[h]){if(this[p]){this[h]=this[p][h]}else{while(!this[h]){this.parent=this.parent[h];if(this.parent){this[h]=this.parent.ends[p]}else{this[h]=aA[h];this.parent=ay;break}}}}if(this[h]){this.insLeftOf(this[h])}else{this.insAtRightEnd(ay)}aA.jQ.remove();if(aA[p]){aA[p].respace()}if(aA[h]){aA[h].respace()}};P.deleteDir=function(ay){av(ay);R(this);this.show();if(this.deleteSelection()){}else{if(this[ay]){if(this[ay].isEmpty()){this[ay]=this[ay].remove()[ay]}else{this.selectDir(ay)}}else{if(this.parent!==this.root){if(this.parent.parent.isEmpty()){return this.insDirOf(-ay,this.parent.parent).deleteDir(ay)}else{this.unwrapGramp()}}}}if(this[p]){this[p].respace()}if(this[h]){this[h].respace()}this.parent.bubble("redraw");return this};P.backspace=function(){return this.deleteDir(p)};P.deleteForward=function(){return this.deleteDir(h)};P.selectFrom=function(aC){var aG=this,aB=aC;loopThroughAncestors:while(true){for(var aD=this;aD!==aG.parent.parent;aD=aD.parent.parent){if(aD.parent===aB.parent){aA=aD;aE=aB;break loopThroughAncestors}}for(var aF=aC;aF!==aB.parent.parent;aF=aF.parent.parent){if(aG.parent===aF.parent){aA=aG;aE=aF;break loopThroughAncestors}}if(aG.parent.parent){aG=aG.parent.parent}if(aB.parent.parent){aB=aB.parent.parent}}var aA,aE,ay;if(aA[h]!==aE){for(var az=aA;az;az=az[h]){if(az===aE[p]){ay=true;break}}if(!ay){ay=aE;aE=aA;aA=ay}}this.hide().selection=Y(aA[p][h]||aA.parent.ends[p],aE[h][p]||aE.parent.ends[h]);this.insRightOf(aE[h][p]||aE.parent.ends[h]);this.root.selectionChanged()};P.selectDir=function(ay){av(ay);R(this);if(this.selection){if(this.selection.ends[ay]===this[-ay]){if(this[ay]){this.hopDir(ay).selection.extendDir(ay)}else{if(this.parent!==this.root){this.insDirOf(ay,this.parent.parent).selection.levelUp()}}}else{this.hopDir(ay);if(this.selection.ends[ay]===this.selection.ends[-ay]){this.clearSelection().show();return}this.selection.retractDir(ay)}}else{if(this[ay]){this.hopDir(ay)}else{if(this.parent===this.root){return}this.insDirOf(ay,this.parent.parent)}this.hide().selection=Y(this[-ay])}this.root.selectionChanged()};P.selectLeft=function(){return this.selectDir(p)};P.selectRight=function(){return this.selectDir(h)};function R(ay){ay.upDownCache={}}P.prepareMove=function(){R(this);return this.show().clearSelection()};P.prepareEdit=function(){R(this);return this.show().deleteSelection()};P.prepareWrite=function(){R(this);return this.show().replaceSelection()};P.clearSelection=function(){if(this.selection){this.selection.clear();delete this.selection;this.root.selectionChanged()}return this};P.deleteSelection=function(){if(!this.selection){return false}this[p]=this.selection.ends[p][p];this[h]=this.selection.ends[h][h];this.selection.remove();this.root.selectionChanged();return delete this.selection};P.replaceSelection=function(){var ay=this.selection;if(ay){this[p]=ay.ends[p][p];this[h]=ay.ends[h][h];delete this.selection}return ay}});var Y=j(af,function(L,P){L.init=function(){var R=this;P.init.apply(R,arguments);R.jQwrap(R.jQ)};L.jQwrap=function(R){this.jQ=R.wrapAll('<span class="selection"></span>').parent()};L.adopt=function(){this.jQ.replaceWith(this.jQ=this.jQ.children());return P.adopt.apply(this,arguments)};L.clear=function(){this.jQ.replaceWith(this.jQ.children());return this};L.levelUp=function(){var ax=this,R=ax.ends[p]=ax.ends[h]=ax.ends[h].parent.parent;ax.clear().jQwrap(R.jQ);return ax};L.extendDir=function(R){av(R);this.ends[R]=this.ends[R][R];this.ends[R].jQ.insAtDirEnd(R,this.jQ);return this};L.extendLeft=function(){return this.extendDir(p)};L.extendRight=function(){return this.extendDir(h)};L.retractDir=function(R){av(R);this.ends[-R].jQ.insDirOf(-R,this.jQ);this.ends[-R]=this.ends[-R][R]};L.retractRight=function(){return this.retractDir(h)};L.retractLeft=function(){return this.retractDir(p)}});C.fn.mathquill=function(az,ay){switch(az){case"redraw":return this.each(function(){var aC=W(this).attr(l),aD=aC&&I[aC];if(aD){(function aB(aE){aE.eachChild(aB);if(aE.redraw){aE.redraw()}}(aD))}});case"revert":return this.each(function(){var aB=W(this).attr(l),aC=aB&&I[aB];if(aC&&aC.revert){aC.revert()}});case"latex":if(arguments.length>1){return this.each(function(){var aB=W(this).attr(l),aC=aB&&I[aB];if(aC){aC.renderLatex(ay)}})}var P=W(this).attr(l),aA=P&&I[P];return aA&&aA.latex();case"text":var P=W(this).attr(l),aA=P&&I[P];return aA&&aA.text();case"html":return this.html().replace(/ ?hasCursor|hasCursor /,"").replace(/ class=(""|(?= |>))/g,"").replace(/<span class="?cursor( blink)?"?><\/span>/i,"").replace(/<span class="?textarea"?><textarea><\/textarea><\/span>/i,"");case"write":if(arguments.length>1){return this.each(function(){var aB=W(this).attr(l),aD=aB&&I[aB],aC=aD&&aD.cursor;if(aC){aC.writeLatex(ay).parent.blur()}})}case"cmd":if(arguments.length>1){return this.each(function(){var aB=W(this).attr(l),aE=aB&&I[aB],aD=aE&&aE.cursor;if(aD){var aC=aD.prepareWrite();if(/^\\[a-z]+$/i.test(ay)){aD.insertCmd(ay.slice(1),aC)}else{aD.insertCh(ay,aC)}aD.hide().parent.blur()}})}default:var L=az==="textbox",R=L||az==="editable",ax=L?ab:o;return this.each(function(){al(W(this),ax(),L,R)})}};C(function(){C(".mathquill-editable:not(.mathquill-rendered-math)").mathquill("editable");C(".mathquill-textbox:not(.mathquill-rendered-math)").mathquill("textbox");C(".mathquill-embedded-latex").mathquill()})}());